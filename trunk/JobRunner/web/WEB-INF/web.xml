<?xml version="1.0" encoding="UTF-8"?>
<web-app version="2.4" xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd">
  
  <!-- ========================================================== -->
  <!-- General -->
  <!-- ========================================================== -->
  
    <description>Job Runner Web Application</description>
    <display-name>JobRunner</display-name>



  <!-- ========================================================== -->
  <!-- Context Parameters -->
  <!-- ========================================================== -->

    <!-- Log4J settings -->
    <context-param>
        <!--
            Preferred repository selector : "preferred" because
            if one is already installed, this choice is ignored.
        -->
        <param-name>log4j-selector</param-name>
        <param-value>org.apache.log4j.selector.ContextClassLoaderSelector</param-value>
    </context-param>

    <context-param>
        <!--
            relative path to config file within current webapp
        -->
        <param-name>log4j-config</param-name>
        <param-value>WEB-INF/classes/log4j.xml</param-value>
    </context-param>


  <!-- ========================================================== -->
  <!-- Filters -->
  <!-- ========================================================== -->

    <filter>
        <filter-name>TimerFilter</filter-name>
        <filter-class>org.ivoa.web.filter.TimerFilter</filter-class>
    </filter>


    <filter-mapping>
        <filter-name>TimerFilter</filter-name>
        <url-pattern>*.do</url-pattern>
        <dispatcher>REQUEST</dispatcher>
    </filter-mapping>


  <!-- ========================================================== -->
  <!-- Listeners -->
  <!-- ========================================================== -->

    <listener>
        <listener-class>org.ivoa.service.ApplicationManager</listener-class>
    </listener>

    <listener>
        <listener-class>org.ivoa.service.SessionMonitor</listener-class>
    </listener>

    <listener>
        <listener-class>org.ivoa.runner.SessionListener</listener-class>
    </listener>


  <!-- ========================================================== -->
  <!-- Servlets -->
  <!-- ========================================================== -->

    <servlet>
        <description>Log4j configuration Servlet</description>
        <servlet-name>Log4JServlet</servlet-name>
        <servlet-class>org.apache.log4j.servlet.ConfigurationServlet</servlet-class>
    </servlet>

  <!-- Queue servlet ... -->
    <servlet>
        <servlet-name>EyalsSAM</servlet-name>
        <servlet-class>eyals.sam.EyalsSAM</servlet-class>
    <init-param>
      <param-name>name</param-name>
      <param-value>EyalsSAM</param-value>
    </init-param>
    <init-param>
      <param-name>executable</param-name>
      <param-value>EyalsSAM.exe</param-value>
    </init-param>
    <init-param>
      <param-name>parameterfile.template</param-name>
      <param-value>parameterfile.template</param-value>
    </init-param>
    <init-param>
      <param-name>treesDir</param-name>
      <param-value>e:/data/millimil/treedata/</param-value>
    </init-param>
    <init-param>
      <param-name>bc03Dir</param-name>
      <param-value>e:/data/BC03/models/Padova1994/chabrier/</param-value>
    </init-param>
    </servlet>

    <servlet>
        <servlet-name>DownloadServlet</servlet-name>
        <servlet-class>org.ivoa.web.servlet.DownloadServlet</servlet-class>
    </servlet>

  
    <!-- servlet mappings -->

    <servlet-mapping>
        <servlet-name>Log4JServlet</servlet-name>
        <url-pattern>/Log4j.do</url-pattern>
    </servlet-mapping>


    <servlet-mapping>
        <servlet-name>EyalsSAM</servlet-name>
        <url-pattern>/Job.do</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>EyalsSAM</servlet-name>
        <url-pattern>/EyalsSAM.do</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>DownloadServlet</servlet-name>
        <url-pattern>/Download.do/*</url-pattern>
    </servlet-mapping>

    <session-config>
        <session-timeout>30</session-timeout>
    </session-config>
  
    <welcome-file-list>
        <welcome-file>index.jsp</welcome-file>
    </welcome-file-list>


  <!-- ========================================================== -->
  <!-- Security -->
  <!-- ========================================================== -->

  <security-role>
  <role-name>JobRunner-member</role-name> 
  </security-role>
  <!--  Define a constraint to restrict access to /secure/* 
  --> 
  <security-constraint>
  <display-name>Security constraint for the web app</display-name> 
  <web-resource-collection>
  <web-resource-name>Protected Area = Administration Web Interface</web-resource-name> 
  <description>Accessible by authorised users</description> 
  <url-pattern>/*</url-pattern> 
  </web-resource-collection>
  <auth-constraint>
  <!--  Only administrator can access this area 
  --> 
  <description>These are the roles who have access</description> 
  <role-name>JobRunner-member</role-name> 
  </auth-constraint>
  </security-constraint>
  <!--  ========================================================== 
  --> 
  <!--  BASIC authentication 
  --> 
  <!--  ========================================================== 
  --> 
  <login-config>
  <auth-method>BASIC</auth-method> 
  </login-config>

      
</web-app>
